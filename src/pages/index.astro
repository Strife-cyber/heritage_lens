---
import Layout from '../layouts/Layout.astro';
---

<Layout title="HBoard - Artefact Manager">
  <div id="app">
    <!-- Canvas pour Three.js -->
    <canvas id="three-canvas"></canvas>
    
    <!-- Grille de fond -->
    <div class="grid-background"></div>
    
    <!-- Cercles de vitesse -->
    <div class="speed-circles">
      <div class="speed-circle circle-1"></div>
      <div class="speed-circle circle-2"></div>
      <div class="speed-circle circle-3"></div>
      <div class="speed-circle circle-4"></div>
      <div class="speed-circle circle-5"></div>
    </div>

    <!-- Plans gris en perspective -->
    <div class="perspective-planes">
      <div class="plane plane-1"></div>
      <div class="plane plane-2"></div>
      <div class="plane plane-3"></div>
      <div class="plane plane-4"></div>
    </div>
    
    <!-- Contenu principal -->
    <div class="content">
      <div class="hero-section">
        <h1 class="title">
          <span class="title-line">H</span>
          <span class="title-line">Board</span>
        </h1>
        <div class="title-underline"></div>
        <p class="subtitle">Gestionnaire d'Artefacts 3D</p>
        <div class="description">
          <p>Cr√©ez, g√©rez et explorez vos artefacts 3D</p>
          <p>Mod√®les, vid√©os et images en un seul endroit</p>
        </div>
        
        <div class="cta-buttons">
          <a href="/upload" class="btn btn-primary">
            <span class="btn-text">Cr√©er un Artefact</span>
            <span class="btn-icon">‚Üí</span>
            <div class="btn-glow"></div>
          </a>
        </div>
      </div>

      <!-- Stats ou infos -->
      <div class="info-cards">
        <div class="info-card">
          <div class="card-icon">üé®</div>
          <h3>Mod√®les 3D</h3>
          <p>Upload et gestion de fichiers .glb</p>
          <div class="card-line"></div>
        </div>
        <div class="info-card">
          <div class="card-icon">üé¨</div>
          <h3>Vid√©os</h3>
          <p>Support pour tous formats vid√©o</p>
          <div class="card-line"></div>
        </div>
        <div class="info-card">
          <div class="card-icon">üñºÔ∏è</div>
          <h3>Images</h3>
          <p>Pr√©visualisation et galerie</p>
          <div class="card-line"></div>
        </div>
      </div>
    </div>
  </div>
</Layout>

<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  #app {
    position: relative;
    width: 100vw;
    height: 100vh;
    overflow: hidden;
    background: #000000;
  }

  #three-canvas {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
    opacity: 0.3;
  }

  /* Grille de fond */
  .grid-background {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 2;
    background-image: 
      linear-gradient(rgba(139, 92, 246, 0.1) 1px, transparent 1px),
      linear-gradient(90deg, rgba(139, 92, 246, 0.1) 1px, transparent 1px);
    background-size: 50px 50px;
    animation: gridMove 20s linear infinite;
  }

  @keyframes gridMove {
    0% { transform: translate(0, 0); }
    100% { transform: translate(50px, 50px); }
  }

  /* Plans gris en perspective */
  .perspective-planes {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 3;
    perspective: 1000px;
    perspective-origin: center center;
    overflow: hidden;
    pointer-events: none;
  }

  .plane {
    position: absolute;
    width: 150%;
    height: 150%;
    left: -25%;
    top: -25%;
    background: linear-gradient(
      90deg,
      transparent 0%,
      rgba(139, 92, 246, 0.05) 50%,
      transparent 100%
    );
    border: 1px solid rgba(139, 92, 246, 0.1);
    transform-origin: center center;
    overflow: hidden;
  }

  .plane-1 {
    animation: planeMove1 15s linear infinite;
  }

  .plane-2 {
    animation: planeMove2 12s linear infinite;
  }

  .plane-3 {
    animation: planeMove3 8s linear infinite;
  }

  .plane-4 {
    animation: planeMove4 5s linear infinite;
  }

  @keyframes planeMove1 {
    0% { 
      transform: rotateX(60deg) translateZ(-500px) translateY(100%);
    }
    100% { 
      transform: rotateX(60deg) translateZ(-500px) translateY(-100%);
    }
  }

  @keyframes planeMove2 {
    0% { 
      transform: rotateX(60deg) translateZ(-300px) translateY(100%);
    }
    100% { 
      transform: rotateX(60deg) translateZ(-300px) translateY(-100%);
    }
  }

  @keyframes planeMove3 {
    0% { 
      transform: rotateX(60deg) translateZ(-100px) translateY(100%);
    }
    100% { 
      transform: rotateX(60deg) translateZ(-100px) translateY(-100%);
    }
  }

  @keyframes planeMove4 {
    0% { 
      transform: rotateX(60deg) translateZ(100px) translateY(100%);
    }
    100% { 
      transform: rotateX(60deg) translateZ(100px) translateY(-100%);
    }
  }

  /* Cercles de vitesse */
  .speed-circles {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 100%;
    height: 100%;
    z-index: 4;
  }

  .speed-circle {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    border: 3px solid #8b5cf6;
    border-radius: 50%;
    pointer-events: none;
    box-shadow: 
      0 0 20px rgba(139, 92, 246, 0.8),
      0 0 40px rgba(139, 92, 246, 0.5),
      inset 0 0 20px rgba(139, 92, 246, 0.3);
  }

  .circle-1 {
    width: 200px;
    height: 200px;
    animation: speedCircle1 8s linear infinite;
  }

  .circle-2 {
    width: 400px;
    height: 400px;
    animation: speedCircle2 6s linear infinite;
  }

  .circle-3 {
    width: 600px;
    height: 600px;
    max-width: 90vw;
    max-height: 90vh;
    animation: speedCircle3 4s linear infinite;
  }

  .circle-4 {
    width: 800px;
    height: 800px;
    max-width: 95vw;
    max-height: 95vh;
    animation: speedCircle4 3s linear infinite;
  }

  .circle-5 {
    width: 1000px;
    height: 1000px;
    max-width: 98vw;
    max-height: 98vh;
    animation: speedCircle5 2s linear infinite;
  }

  @keyframes speedCircle1 {
    0% { 
      transform: translate(-50%, -50%) rotate(0deg) scale(1);
      opacity: 0.8;
      border-color: #8b5cf6;
    }
    50% {
      transform: translate(-50%, -50%) rotate(180deg) scale(1.15);
      opacity: 1;
      border-color: #a78bfa;
    }
    100% { 
      transform: translate(-50%, -50%) rotate(360deg) scale(1);
      opacity: 0.8;
      border-color: #8b5cf6;
    }
  }

  @keyframes speedCircle2 {
    0% { 
      transform: translate(-50%, -50%) rotate(0deg) scale(1);
      opacity: 0.7;
      border-color: #8b5cf6;
    }
    50% {
      transform: translate(-50%, -50%) rotate(-180deg) scale(1.2);
      opacity: 0.9;
      border-color: #a78bfa;
    }
    100% { 
      transform: translate(-50%, -50%) rotate(-360deg) scale(1);
      opacity: 0.7;
      border-color: #8b5cf6;
    }
  }

  @keyframes speedCircle3 {
    0% { 
      transform: translate(-50%, -50%) rotate(0deg) scale(1);
      opacity: 0.6;
      border-color: #8b5cf6;
    }
    50% {
      transform: translate(-50%, -50%) rotate(180deg) scale(1.25);
      opacity: 0.8;
      border-color: #a78bfa;
    }
    100% { 
      transform: translate(-50%, -50%) rotate(360deg) scale(1);
      opacity: 0.6;
      border-color: #8b5cf6;
    }
  }

  @keyframes speedCircle4 {
    0% { 
      transform: translate(-50%, -50%) rotate(0deg) scale(1);
      opacity: 0.5;
      border-color: #8b5cf6;
    }
    50% {
      transform: translate(-50%, -50%) rotate(-180deg) scale(1.3);
      opacity: 0.7;
      border-color: #a78bfa;
    }
    100% { 
      transform: translate(-50%, -50%) rotate(-360deg) scale(1);
      opacity: 0.5;
      border-color: #8b5cf6;
    }
  }

  @keyframes speedCircle5 {
    0% { 
      transform: translate(-50%, -50%) rotate(0deg) scale(1);
      opacity: 0.4;
      border-color: #8b5cf6;
    }
    50% {
      transform: translate(-50%, -50%) rotate(180deg) scale(1.35);
      opacity: 0.6;
      border-color: #a78bfa;
    }
    100% { 
      transform: translate(-50%, -50%) rotate(360deg) scale(1);
      opacity: 0.4;
      border-color: #8b5cf6;
    }
  }

  .content {
    position: relative;
    z-index: 10;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 2rem;
    text-align: center;
  }

  .hero-section {
    max-width: 900px;
    margin-bottom: 4rem;
  }

  .title {
    font-size: clamp(4rem, 12vw, 10rem);
    font-weight: 900;
    color: #ffffff;
    margin-bottom: 1rem;
    letter-spacing: -0.02em;
    line-height: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.2rem;
  }

  .title-line {
    display: block;
    text-shadow: 
      0 0 20px rgba(139, 92, 246, 0.5),
      0 0 40px rgba(139, 92, 246, 0.3),
      0 0 60px rgba(139, 92, 246, 0.2);
  }

  .title-underline {
    width: 200px;
    height: 4px;
    background: linear-gradient(90deg, transparent, #8b5cf6, transparent);
    margin: 1rem auto;
    box-shadow: 0 0 20px rgba(139, 92, 246, 0.8);
    animation: pulseGlow 2s ease-in-out infinite;
  }

  @keyframes pulseGlow {
    0%, 100% { 
      box-shadow: 0 0 20px rgba(139, 92, 246, 0.8);
      opacity: 1;
    }
    50% { 
      box-shadow: 0 0 40px rgba(139, 92, 246, 1);
      opacity: 0.8;
    }
  }

  .subtitle {
    font-size: clamp(1.2rem, 3vw, 2rem);
    color: rgba(255, 255, 255, 0.7);
    margin-bottom: 2rem;
    font-weight: 300;
    letter-spacing: 0.2em;
    text-transform: uppercase;
  }

  .description {
    font-size: clamp(1rem, 2vw, 1.2rem);
    color: rgba(255, 255, 255, 0.6);
    margin-bottom: 3rem;
    line-height: 1.8;
  }

  .description p {
    margin-bottom: 0.5rem;
  }

  .cta-buttons {
    margin-top: 3rem;
  }

  .btn {
    display: inline-flex;
    align-items: center;
    gap: 1rem;
    padding: 1.25rem 3rem;
    font-size: 1.25rem;
    font-weight: 600;
    text-decoration: none;
    border-radius: 8px;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    background: transparent;
    border: 2px solid #8b5cf6;
    color: #ffffff;
  }

  .btn-glow {
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(139, 92, 246, 0.4), transparent);
    transition: left 0.5s ease;
  }

  .btn:hover .btn-glow {
    left: 100%;
  }

  .btn-primary {
    box-shadow: 
      0 0 20px rgba(139, 92, 246, 0.3),
      inset 0 0 20px rgba(139, 92, 246, 0.1);
  }

  .btn-primary:hover {
    background: rgba(139, 92, 246, 0.1);
    transform: translateY(-3px);
    box-shadow: 
      0 10px 40px rgba(139, 92, 246, 0.5),
      inset 0 0 30px rgba(139, 92, 246, 0.2);
  }

  .btn-icon {
    font-size: 1.5rem;
    transition: transform 0.3s ease;
    color: #8b5cf6;
  }

  .btn-primary:hover .btn-icon {
    transform: translateX(5px);
  }

  .info-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 2rem;
    max-width: 1000px;
    width: 100%;
    margin-top: 4rem;
  }

  .info-card {
    background: rgba(255, 255, 255, 0.02);
    backdrop-filter: blur(10px);
    border-radius: 12px;
    padding: 2.5rem 2rem;
    border: 1px solid rgba(139, 92, 246, 0.2);
    transition: all 0.3s ease;
    cursor: pointer;
    position: relative;
    overflow: hidden;
  }

  .info-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 2px;
    background: linear-gradient(90deg, transparent, #8b5cf6, transparent);
    transform: scaleX(0);
    transition: transform 0.3s ease;
  }

  .info-card:hover::before {
    transform: scaleX(1);
  }

  .info-card:hover {
    transform: translateY(-10px);
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(139, 92, 246, 0.5);
    box-shadow: 
      0 20px 40px rgba(0, 0, 0, 0.3),
      0 0 30px rgba(139, 92, 246, 0.2);
  }

  .card-icon {
    font-size: 3rem;
    margin-bottom: 1.5rem;
    display: block;
    filter: grayscale(100%) brightness(1.5);
  }

  .info-card h3 {
    color: #ffffff;
    font-size: 1.5rem;
    margin-bottom: 0.75rem;
    font-weight: 600;
  }

  .info-card p {
    color: rgba(255, 255, 255, 0.6);
    font-size: 0.95rem;
    line-height: 1.6;
  }

  .card-line {
    width: 50px;
    height: 2px;
    background: #8b5cf6;
    margin: 1.5rem auto 0;
    box-shadow: 0 0 10px rgba(139, 92, 246, 0.5);
  }

  @media (max-width: 768px) {
    .info-cards {
      grid-template-columns: 1fr;
      gap: 1.5rem;
    }

    .hero-section {
      margin-bottom: 2rem;
    }

    .speed-circles {
      opacity: 0.5;
    }
  }
</style>

<script>
  import * as THREE from 'three';
  import { gsap } from 'gsap';

  // Attendre que le DOM soit charg√©
  if (typeof window !== 'undefined') {
    window.addEventListener('DOMContentLoaded', () => {
      initThreeJS();
      initAnimations();
    });
  }

  function initThreeJS() {
    const canvas = document.getElementById('three-canvas') as HTMLCanvasElement;
    if (!canvas) return;

    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(
      75,
      window.innerWidth / window.innerHeight,
      0.1,
      1000
    );
    const renderer = new THREE.WebGLRenderer({
      canvas,
      alpha: true,
      antialias: true,
    });

    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

    camera.position.z = 5;

    // Particules violettes
    const particlesGeometry = new THREE.BufferGeometry();
    const particlesCount = 3000;
    const posArray = new Float32Array(particlesCount * 3);

    for (let i = 0; i < particlesCount * 3; i++) {
      posArray[i] = (Math.random() - 0.5) * 30;
    }

    particlesGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));

    const particlesMaterial = new THREE.PointsMaterial({
      size: 0.03,
      color: 0x8b5cf6,
      transparent: true,
      opacity: 0.6,
    });

    const particlesMesh = new THREE.Points(particlesGeometry, particlesMaterial);
    scene.add(particlesMesh);

    // G√©om√©tries violettes
    const geometries: THREE.Mesh[] = [];

    const torusGeometry = new THREE.TorusGeometry(1.5, 0.4, 16, 100);
    const torusMaterial = new THREE.MeshStandardMaterial({
      color: 0x8b5cf6,
      transparent: true,
      opacity: 0.2,
      wireframe: true,
    });
    const torus = new THREE.Mesh(torusGeometry, torusMaterial);
    torus.position.x = -4;
    torus.position.y = 2;
    scene.add(torus);
    geometries.push(torus);

    const icoGeometry = new THREE.IcosahedronGeometry(1.2, 0);
    const icoMaterial = new THREE.MeshStandardMaterial({
      color: 0x8b5cf6,
      transparent: true,
      opacity: 0.2,
      wireframe: true,
    });
    const ico = new THREE.Mesh(icoGeometry, icoMaterial);
    ico.position.x = 4;
    ico.position.y = -2;
    scene.add(ico);
    geometries.push(ico);

    const octaGeometry = new THREE.OctahedronGeometry(1, 0);
    const octaMaterial = new THREE.MeshStandardMaterial({
      color: 0x8b5cf6,
      transparent: true,
      opacity: 0.2,
      wireframe: true,
    });
    const octa = new THREE.Mesh(octaGeometry, octaMaterial);
    octa.position.y = -3;
    scene.add(octa);
    geometries.push(octa);

    const ambientLight = new THREE.AmbientLight(0x8b5cf6, 0.3);
    scene.add(ambientLight);

    const pointLight = new THREE.PointLight(0x8b5cf6, 1);
    pointLight.position.set(5, 5, 5);
    scene.add(pointLight);

    const animate = () => {
      requestAnimationFrame(animate);

      torus.rotation.x += 0.005;
      torus.rotation.y += 0.005;
      ico.rotation.x += 0.005;
      ico.rotation.y += 0.005;
      octa.rotation.x += 0.005;
      octa.rotation.y += 0.005;

      particlesMesh.rotation.y += 0.0005;

      const time = Date.now() * 0.001;
      pointLight.position.x = Math.sin(time) * 5;
      pointLight.position.y = Math.cos(time) * 5;

      renderer.render(scene, camera);
    };

    animate();

    window.addEventListener('resize', () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });
  }

  function initAnimations() {
    gsap.fromTo('.title-line', 
      {
        y: 100,
        opacity: 0,
      },
      {
        duration: 1.5,
        y: 0,
        opacity: 1,
        stagger: 0.2,
        ease: 'power4.out',
      }
    );

    gsap.fromTo('.title-underline',
      {
        scaleX: 0,
      },
      {
        duration: 1,
        scaleX: 1,
        delay: 0.8,
        ease: 'power2.out',
      }
    );

    gsap.fromTo('.subtitle',
      {
        y: 50,
        opacity: 0,
      },
      {
        duration: 1.5,
        y: 0,
        opacity: 1,
        delay: 1,
        ease: 'power4.out',
      }
    );

    gsap.fromTo('.description',
      {
        y: 30,
        opacity: 0,
      },
      {
        duration: 1.5,
        y: 0,
        opacity: 1,
        delay: 1.3,
        ease: 'power4.out',
      }
    );

    gsap.fromTo('.btn',
      {
        scale: 0,
        opacity: 0,
      },
      {
        duration: 1,
        scale: 1,
        opacity: 1,
        delay: 1.6,
        ease: 'back.out(1.7)',
      }
    );

    gsap.fromTo('.info-card',
      {
        y: 50,
        opacity: 0,
      },
      {
        duration: 1,
        y: 0,
        opacity: 1,
        stagger: 0.15,
        delay: 1.9,
        ease: 'power4.out',
      }
    );

    const cards = document.querySelectorAll('.info-card');
    cards.forEach((card) => {
      card.addEventListener('mouseenter', () => {
        gsap.to(card, {
          scale: 1.05,
          duration: 0.3,
          ease: 'power2.out',
        });
      });

      card.addEventListener('mouseleave', () => {
        gsap.to(card, {
          scale: 1,
          duration: 0.3,
          ease: 'power2.out',
        });
      });
    });

    const btn = document.querySelector('.btn-primary');
    if (btn) {
      btn.addEventListener('mouseenter', () => {
        gsap.to('.btn-icon', {
          x: 5,
          duration: 0.3,
          ease: 'power2.out',
        });
      });

      btn.addEventListener('mouseleave', () => {
        gsap.to('.btn-icon', {
          x: 0,
          duration: 0.3,
          ease: 'power2.out',
        });
      });
    }
  }
</script>
